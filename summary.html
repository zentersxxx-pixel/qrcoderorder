<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1>üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h1>
    <p>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞</p>
</header>
<p>‡πÇ‡∏ï‡πä‡∏∞: <span id="table-number">‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏ï‡πä‡∏∞</span></p>
<nav>
  <a href="index.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a> |
  <a href="cart.html">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</a> |
  <a href="summary.html">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</a> |
</nav>

<table id="cart-table">
    <thead>
        <tr>
            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
            <th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
            <th>‡∏£‡∏ß‡∏°</th>
        </tr>
    </thead>
    <tbody id="cart-body"></tbody>
</table>

<h3>üí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="total-price">0.00</span> ‡∏ö‡∏≤‡∏ó</h3>

<div class="cart-actions">
    <button class="btn-back" onclick="history.back()">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
    <button class="btn-checkout" onclick="confirmOrder()">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
</div>

<script>
const cart = JSON.parse(localStorage.getItem("cart")) || {};
const params = new URLSearchParams(window.location.search);

function renderSummary() {
    const body = document.getElementById("cart-body");
    const totalEl = document.getElementById("total-price");

    body.innerHTML = "";
    let total = 0;

    if (!cart || Object.keys(cart).length === 0) {
        body.innerHTML = `
            <tr>
                <td colspan="4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</td>
            </tr>
        `;
        totalEl.innerText = "0.00";
        return;
    }

    for (let id in cart) {
        const item = cart[id];
        const price = Number(item.price) || 0;
        const qty = Number(item.qty) || 0;
        const sum = price * qty;
        total += sum;

        body.insertAdjacentHTML('beforeend', `
            <tr>
                <td>${item.name}</td>
                <td>${price.toFixed(2)}</td>
                <td>${qty}</td>
                <td>${sum.toFixed(2)}</td>
            </tr>
        `);
    }

    totalEl.innerText = total.toFixed(2);
}

function confirmOrder() {
    const orders = JSON.parse(localStorage.getItem("orders")) || [];

    orders.push({
        id: Date.now(),
        table: params.get("table") || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏ï‡πä‡∏∞",
        items: cart,
        total: document.getElementById("total-price").innerText,
        status: "‡∏£‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå",
        createdAt: new Date().toISOString()
    });

    localStorage.setItem("orders", JSON.stringify(orders));
    localStorage.removeItem("cart");
    alert("‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß");
    window.location.href = "index.html";
}

document.getElementById("table-number").innerText = params.get("table") || "‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏ï‡πä‡∏∞";

renderSummary();

</script>
